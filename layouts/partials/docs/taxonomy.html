<!-- ToC menu for autogenerated taxonomy index pages -->

{{ $curterm := .Title }}

<nav>
  <ul>
  {{ range $term, $_ := .Site.Taxonomies }}
    {{ with $.Site.GetPage (printf "/%s" $term | urlize) }}
      {{ if ne (len .Pages) 0 }}

        {{ if in (lower .Title) (lower $curterm) }}
        <li class="book-section-flat">
            {{ $ugh := strings.TrimPrefix (lower $curterm) (lower .Title) }}
            <strong>{{ humanize (strings.TrimPrefix "/" $ugh) }}</strong>
            <ul>
            {{ range .Pages }}
              <li class="flex justify-between">
                <a href="#{{ .Title }}">{{ .Title }}</a>
                <span>{{ len .Pages }}</span>
              </li>
            {{ end }}
            </ul>
          </li>
        {{ end }}

      {{ end }}
    {{ end }}
  {{ end }}
  </ul>
</nav>
